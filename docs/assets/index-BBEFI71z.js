(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(t){if(t.ep)return;t.ep=!0;const r=n(t);fetch(t.href,r)}})();const h=document.querySelector("#criptomonedas"),b=document.querySelector("#moneda"),y=document.querySelector("#formulario"),s=document.querySelector("#resultado"),u=document.querySelector("#botones-grafico"),d={moneda:"",criptomoneda:""},v=o=>new Promise(e=>{e(o)});document.addEventListener("DOMContentLoaded",()=>{E(),y.addEventListener("submit",w),h.addEventListener("change",f),b.addEventListener("change",f)});function E(){fetch("https://min-api.cryptocompare.com/data/top/mktcapfull?limit=10&tsym=USD").then(e=>e.json()).then(e=>v(e.Data)).then(e=>g(e)).catch(e=>console.log(e))}function g(o){o.forEach(e=>{const{FullName:n,Name:i}=e.CoinInfo,t=document.createElement("option");t.value=i,t.textContent=n,h.appendChild(t)})}function f(o){d[o.target.name]=o.target.value}function w(o){o.preventDefault();const{moneda:e,criptomoneda:n}=d;if(e===""||n===""){x("Ambos campos son obligatorios");return}A(),C("histoday"),M()}function x(o){if(!document.querySelector(".error")){const n=document.createElement("div");n.classList.add("error"),n.textContent=o,y.appendChild(n),setTimeout(()=>{n.remove()},3e3)}}function A(){const{moneda:o,criptomoneda:e}=d,n=`https://min-api.cryptocompare.com/data/pricemultifull?fsyms=${e}&tsyms=${o}`;S(),fetch(n).then(i=>i.json()).then(i=>{H(i.DISPLAY[e][o])})}function H(o){L();const{PRICE:e,HIGHDAY:n,LOWDAY:i,CHANGEPCT24HOUR:t,LASTUPDATE:r}=o,c=document.createElement("p");c.classList.add("precio"),c.innerHTML=`El Precio es: <span> ${e} </span>`;const a=document.createElement("p");a.innerHTML=`<p>Precio más alto del día: <span>${n}</span></p>`;const l=document.createElement("p");l.innerHTML=`<p>Precio más bajo del día: <span>${i}</span></p>`;const m=document.createElement("p");m.innerHTML=`<p>Variación últimas 24 horas: <span>${t}%</span></p>`;const p=document.createElement("p");p.innerHTML=`<p>Última Actualización: <span>${r}</span></p>`,s.appendChild(c),s.appendChild(a),s.appendChild(l),s.appendChild(m),s.appendChild(p)}function S(){L();const o=document.createElement("div");o.classList.add("spinner"),o.innerHTML=`
        <div class="bounce1"></div>
        <div class="bounce2"></div>
        <div class="bounce3"></div>    
    `,s.appendChild(o)}function L(){for(;s.firstChild;)s.removeChild(s.firstChild)}function C(o){const{criptomoneda:e,moneda:n}=d;if(!e||!n)return;const i=`https://min-api.cryptocompare.com/data/v2/${o}?fsym=${e}&tsym=${n}&limit=100`;fetch(i).then(t=>t.json()).then(t=>{const c=t.Data.Data.map(a=>({x:new Date(a.time*1e3),y:[a.open,a.high,a.low,a.close]}));D(c)}).catch(t=>console.error("Error al obtener los datos históricos:",t))}function D(o){window.miGrafico&&window.miGrafico.destroy();const e={series:[{data:o}],chart:{type:"candlestick",height:350,toolbar:{show:!1}},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0},labels:{style:{colors:"#ffffff"}}},theme:{mode:"dark"}};window.miGrafico=new ApexCharts(document.querySelector("#grafico"),e),window.miGrafico.render()}function M(){u.innerHTML="",[{id:"histoday",texto:"Día"},{id:"histohour",texto:"Hora"},{id:"histominute",texto:"Minuto"}].forEach(e=>{const n=document.createElement("button");n.textContent=e.texto,n.classList.add("btn","btn-secondary","mx-2","bg-primary","text-white"),n.addEventListener("click",()=>C(e.id)),u.appendChild(n)})}
